# Travel Policy Configuration

## Files

### manifest.yaml (SOURCE OF TRUTH)
The `manifest.yaml` file is the **single source of truth** for persona configuration.
- Used by Python services (authz-api, persona-api, etc.)
- Defines persona titles, statuses, and attributes
- Must be edited manually

### persona_config.json (GENERATED)
The `persona_config.json` file is **automatically generated** from `manifest.yaml`.
- Used by OPA policy engine (policy.rego)
- **DO NOT edit this file manually** - your changes will be overwritten
- Regenerate after modifying manifest.yaml

### policy.rego
The Rego policy file that implements authorization logic.

## Generating persona_config.json

After modifying `manifest.yaml`, regenerate the JSON file:

```bash
# From repository root:
python3 scripts/generate-opa-persona-config.py travel
```

Or for Docker/Cloud Run builds, the JSON is generated automatically during the build process.

## Integration Points

1. **Python Services** → Read `manifest.yaml` via `persona_config.py` library
2. **OPA Policy** → Read `persona_config.json` via `import data.travel.persona_config`
3. **Build Process** → Generates `persona_config.json` from `manifest.yaml`

This ensures consistency across all components.
